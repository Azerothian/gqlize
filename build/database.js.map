{"version":3,"sources":["database.js"],"names":["connect","createSubscriptionHook","loadSchemas","log","schemas","sqlInstance","options","schema","hookName","subscriptionName","pubsub","schemaOptions","hooks","schemaHook","isSubHook","error","schemaHookName","f","instance","apply","err","debug","undefined","output","publish","schemaName","name","$sqlgql","defaultAttr","defaultModel","subscriptionHooks","subscriptions","Object","assign","sc","map","s","$subscriptions","reduce","data","hookFunc","names","classMethods","instanceMethods","test","version","define","models","keys","forEach","classMethod","instanceMethod","prototype","relationships","relationship","createRelationship","model","type","as","targetModel","sourceModel","source","target","rel"],"mappings":"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","file":"database.js","sourceRoot":"../src/"}